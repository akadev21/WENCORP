<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <!-- Majesty Project Form View -->
    <record id="view_majesty_commercial_project_form" model="ir.ui.view">
        <field name="name">majesty.projects.commercial.form</field>
        <field name="model">commercial.project</field>
        <field name="arch" type="xml">


            <form>
                <header>
                    <field name="state_commercial" widget="statusbar"/>
                    <!-- Button to send to designer -->
                    <button name="action_send_to_designer"
                            string="Envoyer au Designer"
                            type="object"
                            class="btn-primary"
                             invisible=" state_commercial != 'preparation'"/>

                    <!-- Button to validate designer -->
                    <button name="action_send_to_designer"
                            string="Valider Design"
                            type="object"
                            class="btn-primary"
                             invisible=" state_commercial != 'design_in_progress'"
                           />
                    <button name="action_invalidate_designer"
                            string="Design Non Valide"
                            type="object"
                            class="btn-secondary"
                             invisible=" state_commercial != 'design_completed'"
                    />
                </header>
                <field name="bat_cancel" invisible="1"/>
                <div class="alert alert-danger text-center o_form_header" role="status"
                     invisible=" bat_cancel != True">
                    <a class="close" data-dismiss="alert" href="#" aria-label="Close">x</a>
                    <div>
                        <strong>Raison de Refus :
                            <field name="invalidation_reason"/>
                        </strong>
                    </div>
                </div>
                <sheet>
                    <group>
                        <group>

                            <field name="reference" string="Référence" readonly="1"/>
                            <field name="project" string="Nom du Projet"/>
                            <field name="client" string="Client"/>
                            <field name="devis" string="Référence du Devis" widget="binary"
                                   filename="ref_devis_filename"/>
                            <field name="devis_filename" invisible="1"/>
                        </group>

                        <group>
                            <field name="designer" string="Designer"/>
                            <field name="designer_assign_date" string="Date d'Attribution du Designer" readonly="1"/>
                            <field name="bat" string="BAT" widget="binary" readonly="1" filename="bat_filename"
                                   
                            />

                            <field name="bat_filename" string="BAT"

                            />


                        </group>
                            <lable>Description</lable>
                        <field name="description" string="Description"/>
                         <lable>Commentaire</lable>
                        <field name="comment" string="Commentaire"/>
                    </group>

                    <notebook>
                        <page string="Documents Projet">
                            <field name="document_ids" create="Ajouter une ligne">
                                <tree editable="bottom">
                                  <field name="document_binary" widget="binary" filename="document_name" string="Document"/>
                                    <field name="document_name" string="Nom du document"/>


                                </tree>
                            </field>
                        </page>
                        <!-- Tab for Products -->
                        <page string="Liste des Articles">
                            <field name="product_ids">
                                <tree editable="bottom">
                                    <field name="project_id"/>
                                    <field name="product_id"/>
                                    <field name="description_sale"/>
                                    <field name="quantity"/>
                                    <field name="gender"/>
                                    <field name="customizable"/>
                                    <field name="model_design" string="Design" widget="binary"
                                           filename="model_design_filename"/>
                                    <field name="model_design_filename" column_invisible="1"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <!-- Tab for Documents -->

                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>
    <record id="view_majesty_commercial_project_tree" model="ir.ui.view">
        <field name="name">majesty.project.commercial.tree</field>
        <field name="model">commercial.project</field>
        <field name="arch" type="xml">
            <!-- Add fields before and after the display_name field -->
            <tree>
                <field name="reference"/>
                <field name="project"/>
                <field name="client"/>
                <field name="creation_date"/>
                <field name="state_commercial"/>

                <!-- Hide unnecessary fields -->
            </tree>
        </field>



    </record>
<!--    view kanban-->
        <record id="view_majesty_commercial_project_kanban" model="ir.ui.view">
    <field name="name">majesty.project.commercial.kanban</field>
    <field name="model">commercial.project</field>
    <field name="arch" type="xml">
        <kanban default_group_by="state_commercial">
            <field name="state_commercial"/>
            <field name="reference"/>
            <field name="project"/>
            <field name="client"/>
            <field name="designer"/>
            <field name="creation_date"/>

            <templates>
                <t t-name="kanban-box">
                     <div t-attf-class="oe_kanban_card oe_kanban_global_click
                        #{record.state_commercial.raw === 'preparation' ? 'bg-primary' : ''}
                        #{record.state_commercial.raw === 'design_in_progress' ? 'bg-info' : ''}
                        #{record.state_commercial.raw === 'design_completed' ? 'bg-success' : ''}
                        #{record.state_commercial.raw === 'canceled' ? 'bg-danger' : ''}">


                        <div class="oe_kanban_details">
                            <strong>
                                 <field name="reference"/>  <!-- Reference Label -->
                            </strong>
                            <div>
                                <strong>Nom:</strong> <field name="project" />
                            </div>
                            <div>
                                <strong>Client:</strong><field name="client" />
                            </div>

                            <div>
                                 <span>Designer: </span><field name="designer"/>
                            </div>
                            <div>
                                   <span>Crée le: </span><field name="creation_date"/>
                            </div>
                        </div>
                    </div>
                </t>
            </templates>
        </kanban>
    </field>
</record>



    <!-- Action for the menu -->
    <record id="action_majesty_project" model="ir.actions.act_window">
        <field name="name">Projets</field>
        <field name="res_model">commercial.project</field>
        <field name="view_mode">tree,kanban,form</field>
    </record>

    <!-- Menu for Majesty Projects -->
    <menuitem id="menu_majesty_commercial_project"
              name="Projets"
              action="action_majesty_project"
              parent="menu_root_commercial"
              sequence="1"/>

    <!-- Sequence for project reference -->
    <record id="seq_project_reference_fix_new" model="ir.sequence">
        <field name="name">Project Reference</field>
        <field name="code">project.reference_fix_new</field>
        <field name="prefix">PRO-%(year)s%(month)s%(day)s-</field>
        <field name="padding">4</field>
        <field name="number_next">1</field>
        <field name="implementation">standard</field>
    </record>
</odoo>
