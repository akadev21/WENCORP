<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <!-- Majesty Project Form View -->
    <record id="view_majesty_commercial_project_form" model="ir.ui.view">
        <field name="name">majesty.projects.commercial.form</field>
        <field name="model">commercial.project</field>
        <field name="arch" type="xml">


            <form>
                <header>
                    <field name="state_commercial" widget="statusbar"/>
                    <!-- Button to send to designer -->
                    <button name="action_send_to_designer"
                            string="Envoyer au Designer"
                            type="object"
                            class="btn-primary"
                            modifiers="{'invisible': [('state_commercial', '!=', 'preparation')]}"/>

                    <!-- Button to validate designer -->
                    <button name="action_send_to_designer"
                            string="Valider Design"
                            type="object"
                            class="btn-primary"
                            modifiers="{'invisible': [('state_commercial', '!=', 'design_in_progress')]}"/>
                    <button name="action_design_non_valide"
                            string="Design Non Valide"
                            type="object"
                            class="btn-secondary"
                            modifiers="{'invisible': [('state_commercial', '!=', 'design_completed')]}"/>
                </header>
                <sheet>
                    <group>
                        <group>

                            <field name="reference" string="Référence" readonly="1"/>
                            <field name="project" string="Nom du Projet"/>
                            <field name="client" string="Client"/>
                            <field name="devis" string="Référence du Devis" widget="binary"
                                   filename="ref_devis_filename"/>
                            <field name="devis_filename" invisible="1"/>
                        </group>

                        <group>
                            <field name="designer" string="Designer"/>
                            <field name="designer_assign_date" string="Date d'Attribution du Designer" readonly="1"/>
                            <field name="bat" string="BAT" widget="binary" readonly="1" filename="bat_filename"
                                   modifiers="{'invisible': [('commercial_state', '=', 'design_in_progress')]}"
                            />

                            <field name="bat_filename" string="BAT"
                                   modifiers="{'invisible': [('commercial_state', '=', 'design_in_progress')]}"
                            />

                        </group>

                        <field name="description" string="Description"/>
                        <field name="comment" string="Commentaire"/>
                    </group>

                    <notebook>
                        <page string="Documents-Projet">
                            <field name="document_ids" create="Ajouter une ligne">
                                <tree editable="bottom">
                                    <field name="document_binary" widget="binary" filename="document_name"/>
                                    <field name="document_name"/>

                                </tree>
                            </field>
                        </page>
                        <!-- Tab for Products -->
                        <page string="Liste des Articles">
                            <field name="product_ids">
                                <tree editable="bottom">
                                    <field name="product_id"/>
                                    <field name="description_sale"/>
                                    <field name="quantity"/>
                                    <field name="gender"/>
                                    <field name="customizable"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <!-- Tab for Documents -->

                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>
    <record id="view_majesty_commercial_project_tree" model="ir.ui.view">
        <field name="name">majesty.project.commercial.tree</field>
        <field name="model">commercial.project</field>
        <field name="arch" type="xml">
            <!-- Add fields before and after the display_name field -->
            <tree>
                <field name="reference"/>
                <field name="project"/>
                <field name="client"/>
                <field name="creation_date"/>
                <field name="state_commercial"/>

                <!-- Hide unnecessary fields -->
            </tree>
        </field>


    </record>
    <!-- Action for the menu -->
    <record id="action_majesty_project" model="ir.actions.act_window">
        <field name="name">Projets</field>
        <field name="res_model">commercial.project</field>
        <field name="view_mode">tree,kanban,form</field>
    </record>

    <!-- Menu for Majesty Projects -->
    <menuitem id="menu_majesty_commercial_project"
              name="Projets"
              action="action_majesty_project"
              parent="menu_root_commercial"
              sequence="1"/>

    <!-- Sequence for project reference -->
    <record id="seq_project_reference_fix_new" model="ir.sequence">
        <field name="name">Project Reference</field>
        <field name="code">project.reference_fix_new</field>
        <field name="prefix">PRO-%(year)s%(month)s%(day)s-</field>
        <field name="padding">4</field>
        <field name="number_next">1</field>
        <field name="implementation">standard</field>
    </record>
</odoo>
